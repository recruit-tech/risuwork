
# 競技日程
競技日程: 2024年08月30日(金)
競技時間: 9:30 - 17:30 (JST) の8時間とする

# 禁止事項
以下の行為を特に禁止する。

* 競技終了時間までに、出題内容に関するあらゆる事項(問題内容・計測ツールの計測方法など)を公開・共有すること ※ただし主催者が公開している情報は除く
* 他チームの選手と連絡を取り、問題内容等を共有する事 (結託行為) も禁止とする。
* 主催者が他チームへの妨害とみなす全ての行為

# インフラ事項
主催者からAWSアカウントが配布され、それを競技に利用する。
アプリケーションに利用するリソースとして、

- ECS (EC2起動タイプ)
- RDS
- ALB

が事前に配布される。上記をベンチマーク中に利用が認められたコンピューティングリソースとする。

デプロイ/作業用のリソースとして

- ECR
- CodeBuild
- EC2(作業用)

が配布される。


**新しいコンピューティングリソースの追加、および配布されたリソースのインスタンスタイプの変更を禁止する。**

**許可される事項**には、例として以下のような作業が含まれる。

- ECSのタスク定義の変更
- RDSのパラメータグループの変更



**禁止される事項**には、例として以下のような作業が含まれる。

- アプリケーション用途でのコンピューティングリソースとしてEC2を追加する
- RDSのインスタンスタイプを変更する

※許可/禁止の判断に迷う操作の場合は、遠慮無く質問してください。

# ソフトウェア事項
コンテストにあたり、参加者は与えられたソフトウェア、もしくは自分で競技時間内に実装したソフトウェアを用いる。 高速化対象のソフトウェアとして主催者からWebアプリケーションが与えられる（GitHubリポジトリで配布）。 どのような言語版が提供されるかは事前にアナウンスするが、各々の性能が一致することを主催者は保証しない。 どれをベースに用いてもよいし、独自で実装したものを用いてもよい。

※ もしも競技開始後に参考実装に不具合等が見つかった際、修正のパッチが配られることがあります。

競技における高速化対象のアプリケーションとして与えられたアプリケーションから、以下の部分は変更しないこと。

- アクセス先のURI、ただしサーバー側で生成する部分（IDなど）は文字種（[0-9] や [0-9a-zA-Z_] など）を変えない範囲で自由に生成しても良い
- レスポンス(JSON)の構造

各サーバ（またはコンテナ）におけるソフトウェアの入れ替え、設定の変更、アプリケーションコードの変更および入れ替えなどは一切禁止しない。 ベンチマーク中に利用が認められたコンピューティングリソース以外の外部リソースを使用する行為(他のインスタンスに処理を委譲するなど) は禁止する。 ただしモニタリングやテスト、開発などは、PCや外部のサーバーを利用しても構わない。

許可される事項には、例として以下のような作業が含まれる。

- 各サーバ（またはコンテナ）の役割の変更
- DBスキーマの変更やインデックスの作成・削除
- データベースに利用するミドルウェアの変更
- キャッシュ機構の追加、ジョブキュー機構の追加による遅延書き込み
- 他の言語による再実装
- Dockerfileの変更


ただし以下の事項に留意すること。

- コンテスト進行用のメンテナンスコマンドが正常に動作するよう互換性を保つこと
- サーバ再起動後にすべてのアプリケーションコードが正常動作する状態を維持すること
- ベンチマーク実行時にアプリケーションに書き込まれたデータは再起動後にも取得できること





# 負荷走行について
ベンチマーカーによる負荷走行は以下のように実施されます。

- 初期化処理の実行 POST /api/initialize
- アプリケーション整合性チェック（数秒～数十秒）
- 負荷テスト（60秒間）
- 最終チェック（数秒～数十秒）

初期化処理もしくはアプリケーション整合性チェックに失敗すると、負荷走行は即時失敗（fail）になります。

負荷テスト終了時点で HTTP レスポンスの処理を打ち切ります。未完了のリクエストなどは強制的に切断されます。負荷テスト終了以降に強制的に切断されたリクエストはスコア、検証には影響しません

## ベンチマーカーのタイムアウトについて
ベンチマーカーのリクエストタイムアウトはそれぞれ以下のように設定されています。

- 初期化処理の実行: 30秒
- アプリケーションの整合性チェック: 10秒
- 負荷テスト: 3秒
- 最終チェック: 10秒

## 負荷走行の打ち切り
後述する即時失敗（fail）となった場合、ベンチマーカーはそこで負荷走行を打ち切ります。

# スコア計算
整合性チェックを通過し負荷走行が開始されると、下記の通り加点・減点が行われます。 加点対象のリクエストは、負荷走行中に送信されたリクエストのみです。

- カスタマーの新規登録(POST /api/cs/signup)に成功した場合
  - 1回あたり1点
- カスタマーのログイン(POST /api/cs/login)に成功した場合
  - 1回あたり1点
- カスタマーのログアウト(POST /api/cs/logout)に成功した場合
  - 1回あたり1点
- クライアントの新規登録(POST /api/cl/signup)に成功した場合
  - 1回あたり1点
- クライアントのログイン(POST /api/cl/login)に成功した場合
  - 1回あたり1点
- クライアントのログアウト(POST /api/cl/logout)に成功した場合
  - 1回あたり1点
- 求人応募(POST /api/cs/application)に成功した場合
  - 1回あたり5点
- その他の処理に成功した場合
  - 1回あたり3点
ただし、/admin配下へのリクエストは加点されません
整合性のチェックのみ行います

## 負荷走行時における即時失敗（fail）について

下記のエラーは即時失敗（fail）となります。fail となった場合、スコアは 0 点となります。

- 初期化処理、整合性チェックのいずれかに失敗した場合
  - 1回以上で fail
- HTTP ステータスコードやレスポンス内容などに誤りがある場合
  - 1回以上で fail
- リクエストがタイムアウトした場合
  - 加点減点なし



# 順位計算
順位は、

**(最後に記録された点数*1.1) 以内の最高点数**

で順位付けを行う。最高点ではなく、最後の点数から10% 以内の誤差を認めた上での最高点なので留意すること。


# 備考
ちなみに今回めっちゃ運営頑張ったんですが、多分随所に不具合等が見られるかと思います。遠慮なく slack で不具合と思われる箇所を聞いてください。今回の R-ISUCON は運営と共にイベントを成立させようという「広い心」でいていただけると助かります。